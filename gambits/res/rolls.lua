-- gambits resource file: rolls

local rolls = {
 ['values'] = {
   ["corsair's roll"] = {
     [1] = 10,
     [2] = 11,
     [3] = 11,
     [4] = 12,
     [5] = 20,
     [6] = 13,
     [7] = 15,
     [8] = 16,
     [9] = 8,
     [10] = 17,
     [11] = 24,
     ['buff_id'] = 326,
   },

   ["ninja's roll"] = {
     [1] = 10,
     [2] = 13,
     [3] = 15,
     [4] = 40,
     [5] = 18,
     [6] = 20,
     [7] = 25,
     [8] = 5,
     [9] = 28,
     [10] = 30,
     [11] = 50,
     ['buff_id'] = 322,
   },

   ["hunter's roll"] = {
     [1] = 10,
     [2] = 13,
     [3] = 15,
     [4] = 40,
     [5] = 18,
     [6] = 20,
     [7] = 25,
     [8] = 5,
     [9] = 28,
     [10] = 30,
     [11] = 50,
     ['buff_id'] = 320,
   },

   ["chaos roll"] = {
     [1] = 64,
     [2] = 80,
     [3] = 96,
     [4] = 256,
     [5] = 112,
     [6] = 128,
     [7] = 160,
     [8] = 32,
     [9] = 176,
     [10] = 192,
     [11] = 320,
     ['buff_id'] = 317,
   },

   ["magus's roll"] = {
     [1] = 5,
     [2] = 20,
     [3] = 6,
     [4] = 8,
     [5] = 9,
     [6] = 3,
     [7] = 10,
     [8] = 13,
     [9] = 14,
     [10] = 15,
     [11] = 25,
     ['buff_id'] = 325,
   },

   ["healer's roll"] = {
     [1] = 3,
     [2] = 4,
     [3] = 12,
     [4] = 5,
     [5] = 6,
     [6] = 7,
     [7] = 1,
     [8] = 8,
     [9] = 9,
     [10] = 10,
     [11] = 16,
     ['buff_id'] = 312,
   },

   ["drachen's roll"] = {
     [1] = 10,
     [2] = 13,
     [3] = 15,
     [4] = 40,
     [5] = 18,
     [6] = 20,
     [7] = 25,
     [8] = 5,
     [9] = 28,
     [10] = 30,
     [11] = 50,
     ['buff_id'] = 323,
   },

   ["choral roll"] = {
     [1] = 8,
     [2] = 42,
     [3] = 11,
     [4] = 15,
     [5] = 19,
     [6] = 4,
     [7] = 23,
     [8] = 27,
     [9] = 31,
     [10] = 35,
     [11] = 50,
     ['buff_id'] = 319,
   },

   ["monk's roll"] = {
     [1] = 8,
     [2] = 10,
     [3] = 32,
     [4] = 12,
     [5] = 14,
     [6] = 16,
     [7] = 4,
     [8] = 20,
     [9] = 22,
     [10] = 24,
     [11] = 40,
     ['buff_id'] = 311,
   },

   ["beast roll"] = {
     [1] = 64,
     [2] = 80,
     [3] = 96,
     [4] = 256,
     [5] = 112,
     [6] = 128,
     [7] = 160,
     [8] = 32,
     [9] = 176,
     [10] = 192,
     [11] = 320,
     ['buff_id'] = 318,
   },

   ["samurai roll"] = {
     [1] = 8,
     [2] = 32,
     [3] = 10,
     [4] = 12,
     [5] = 14,
     [6] = 4,
     [7] = 16,
     [8] = 20,
     [9] = 22,
     [10] = 24,
     [11] = 40,
     ['buff_id'] = 321,
   },

   ["evoker's roll"] = {
     [1] = 1,
     [2] = 1,
     [3] = 1,
     [4] = 1,
     [5] = 3,
     [6] = 2,
     [7] = 2,
     [8] = 2,
     [9] = 1,
     [10] = 3,
     [11] = 4,
     ['buff_id'] = 324,
   },

   ["rogue's roll"] = {
     [1] = 1,
     [2] = 2,
     [3] = 3,
     [4] = 4,
     [5] = 10,
     [6] = 5,
     [7] = 6,
     [8] = 7,
     [9] = 1,
     [10] = 8,
     [11] = 14,
     ['buff_id'] = 315,
   },

   ["warlock's roll"] = {
     [1] = 2,
     [2] = 3,
     [3] = 4,
     [4] = 12,
     [5] = 5,
     [6] = 6,
     [7] = 7,
     [8] = 1,
     [9] = 8,
     [10] = 9,
     [11] = 15,
     ['buff_id'] = 314,
   },

   ["fighter's roll"] = {
     [1] = 1,
     [2] = 2,
     [3] = 3,
     [4] = 4,
     [5] = 10,
     [6] = 5,
     [7] = 6,
     [8] = 6,
     [9] = 1,
     [10] = 7,
     [11] = 15,
     ['buff_id'] = 310,
   },

   ["puppet roll"] = {
     [1] = 5,
     [2] = 8,
     [3] = 35,
     [4] = 11,
     [5] = 14,
     [6] = 18,
     [7] = 2,
     [8] = 22,
     [9] = 26,
     [10] = 30,
     [11] = 40,
     ['buff_id'] = 327,
   },

   ["gallant's roll"] = {
     [1] = 48,
     [2] = 60,
     [3] = 200,
     [4] = 72,
     [5] = 88,
     [6] = 104,
     [7] = 32,
     [8] = 120,
     [9] = 140,
     [10] = 160,
     [11] = 240,
     ['buff_id'] = 316,
   },

   ["wizard's roll"] = {
     [1] = 4,
     [2] = 6,
     [3] = 8,
     [4] = 10,
     [5] = 25,
     [6] = 12,
     [7] = 14,
     [8] = 17,
     [9] = 2,
     [10] = 20,
     [11] = 30,
     ['buff_id'] = 313,
   },

   ["dancer's roll"] = {
     [1] = 3,
     [2] = 4,
     [3] = 12,
     [4] = 5,
     [5] = 6,
     [6] = 7,
     [7] = 1,
     [8] = 8,
     [9] = 9,
     [10] = 10,
     [11] = 16,
     ['buff_id'] = 328,
   },

   ["scholar's roll"] = {
     [1] = 2,
     [2] = 10,
     [3] = 3,
     [4] = 4,
     [5] = 4,
     [6] = 1,
     [7] = 5,
     [8] = 6,
     [9] = 7,
     [10] = 7,
     [11] = 12,
     ['buff_id'] = 329,
   },

   ["naturalist's roll"] = {
     [1] = 6,
     [2] = 7,
     [3] = 15,
     [4] = 8,
     [5] = 9,
     [6] = 10,
     [7] = 5,
     [8] = 11,
     [9] = 12,
     [10] = 13,
     [11] = 20,
     ['buff_id'] = 339,
   },

   ["runeist's roll"] = {
     [1] = 10,
     [2] = 13,
     [3] = 15,
     [4] = 40,
     [5] = 18,
     [6] = 20,
     [7] = 25,
     [8] = 5,
     [9] = 28,
     [10] = 30,
     [11] = 50,
     ['buff_id'] = 600,
   },

   ["bolter's roll"] = {
     [1] = 6,
     [2] = 6,
     [3] = 16,
     [4] = 8,
     [5] = 8,
     [6] = 10,
     [7] = 10,
     [8] = 12,
     [9] = 4,
     [10] = 14,
     [11] = 20,
     ['buff_id'] = 330,
   },

   ["caster's roll"] = {
     [1] = 6,
     [2] = 15,
     [3] = 7,
     [4] = 8,
     [5] = 9,
     [6] = 10,
     [7] = 5,
     [8] = 11,
     [9] = 12,
     [10] = 13,
     [11] = 20,
     ['buff_id'] = 331,
   },

   ["blitzer's roll"] = {
     [1] = 2,
     [2] = 3,
     [3] = 4,
     [4] = 11,
     [5] = 5,
     [6] = 6,
     [7] = 7,
     [8] = 8,
     [9] = 1,
     [10] = 10,
     [11] = 12,
     ['buff_id'] = 333,
   },

   ["tactician's roll"] = {
     [1] = 10,
     [2] = 10,
     [3] = 10,
     [4] = 10,
     [5] = 30,
     [6] = 10,
     [7] = 10,
     [8] = 0,
     [9] = 20,
     [10] = 20,
     [11] = 40,
     ['buff_id'] = 334,
   },

   ["allies' roll"] = {
     [1] = 2,
     [2] = 3,
     [3] = 20,
     [4] = 5,
     [5] = 7,
     [6] = 9,
     [7] = 11,
     [8] = 13,
     [9] = 15,
     [10] = 1,
     [11] = 25,
     ['buff_id'] = 335,
   },

   ["miser's roll"] = {
     [1] = 30,
     [2] = 50,
     [3] = 70,
     [4] = 90,
     [5] = 200,
     [6] = 110,
     [7] = 20,
     [8] = 130,
     [9] = 150,
     [10] = 170,
     [11] = 250,
     ['buff_id'] = 336,
   },

   ["companion's roll"] = {
     [1] = 21,
     [2] = 50,
     [3] = 22,
     [4] = 23,
     [5] = 30,
     [6] = 31,
     [7] = 32,
     [8] = 41,
     [9] = 42,
     [10] = 10,
     [11] = 60,
     ['buff_id'] = 337
   },
 },

 ['buff_ids'] = {
   [310] = "fighter's roll",
   [311] = "monk's roll",
   [312] = "healer's roll",
   [313] = "wizard's roll",
   [314] = "warlock's roll",
   [315] = "rogue's roll",
   [316] = "gallant's roll",
   [317] = "chaos roll",
   [318] = "beast roll",
   [319] = "choral roll",
   [320] = "hunter's roll",
   [321] = "samurai roll",
   [322] = "ninja's roll",
   [323] = "drachen's roll",
   [324] = "evoker's roll",
   [325] = "magus's roll",
   [326] = "corsair's roll",
   [327] = "puppet roll",
   [328] = "dancer's roll",
   [329] = "scholar's roll",
   [330] = "bolter's roll",
   [331] = "caster's roll",
   [332] = "courser's roll",
   [333] = "blitzer's roll",
   [334] = "tactician's roll",
   [335] = "allies' roll",
   [336] = "miser's roll",
   [337] = "companion's roll",
   [338] = "avenger's roll",
   [339] = "naturalist's roll",
   [600] = "runeist's roll"
 },

 ['action_ids'] = {
   [108] = "hunter's roll",
   [112] = "evoker's roll",
   [114] = "corsair's roll",
   [116] = "dancer's roll",
   [118] = "bolter's roll",
   [121] = "blitzer's roll",
   [391] = "runeist's roll"
 },

 ['should_double'] = function(roll, current_value)
   if roll and current_value then
     local weights = 0
     local current_effect = roll[current_value]
     local effect_increase = 0
     local total_weight = 0
     for i = 1, 6 do
       if current_value + i >= 12 then
         weight = -3
       else
         effect_increase = current_effect / roll[current_value + i]
         if effect_increase < 1 then -- roll-up effect value would be higher
           if effect_increase <= .8 then -- at least a 20% increase
             weight = 2
           else
             weight = 1
           end
         elseif effect_increase > 1 then -- roll-up effect value would be lower
           if effect_increase >= 1.2 then -- at least a 20% decrease
             weight = -2
           else
             weight = -1
           end
         else -- roll effect values are equal
           weight = 0
         end
       end

       total_weight = total_weight + weight
     end

     return total_weight > 0
   else
     return false
   end
 end
}

for buff_id, roll_name in pairs(rolls.buff_ids) do
 rolls.values[buff_id] = rolls.values[roll_name]
end

return rolls
